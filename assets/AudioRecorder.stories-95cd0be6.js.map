{"version":3,"file":"AudioRecorder.stories-95cd0be6.js","sources":["../../node_modules/.pnpm/react@18.2.0/node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js","../../src/utils/assert.ts","../../src/utils/isError.ts","../../src/hooks/useAudioCapture.tsx","../../src/stories/AudioRecorder.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","export function assert(condition: any, msg?: string): asserts condition {\n  if (!condition) {\n    throw new Error(msg);\n  }\n}\n","export function isError(error: unknown): error is Error {\n  return error instanceof Error;\n}\n","import { useCallback, useRef } from 'react';\nimport { assert } from '~utils/assert.ts';\nimport { isError } from '~utils/isError.ts';\nimport { UseAudioCaptureProps } from './useAudioCapture.types.ts';\n\nexport const useAudioCapture = (props?: UseAudioCaptureProps) => {\n  const chunks = useRef<Blob[]>([]);\n  const mediaStream = useRef<MediaStream | null>(null);\n  const mediaRecorder = useRef<MediaRecorder | null>(null);\n\n  const requestPermissions = useCallback(async () => {\n    if (typeof window === 'undefined') return;\n    assert(navigator.mediaDevices, 'MediaDevices not supported');\n\n    const stream = await navigator.mediaDevices.getUserMedia({\n      audio: true,\n      video: false,\n    });\n\n    mediaStream.current = stream;\n\n    const recorder = new MediaRecorder(stream);\n\n    recorder.onstart = async (e) => {\n      props?.onStart?.(e, {\n        mediaStream: stream,\n      });\n    };\n\n    recorder.onstop = (e) => {\n      props?.onStop?.(e, chunks.current, {\n        mediaStream: stream,\n      });\n    };\n\n    recorder.onpause = (e) => {\n      props?.onPause?.(e, chunks.current, {\n        mediaStream: stream,\n      });\n    };\n\n    recorder.onerror = (e) => {\n      props?.onError?.(e, {\n        mediaStream: stream,\n        error: new Error('An error occurred while recording'),\n      });\n    };\n\n    recorder.onresume = (e) => {\n      props?.onResume?.(e, chunks.current, {\n        mediaStream: stream,\n      });\n    };\n\n    recorder.ondataavailable = async (e) => {\n      chunks.current.push(e.data);\n      props?.onChunk?.(e, {\n        mediaStream: stream,\n      });\n    };\n\n    mediaRecorder.current = recorder;\n  }, [props]);\n\n  const startRecording = useCallback(async () => {\n    try {\n      if (mediaRecorder.current?.state === 'recording') return;\n\n      chunks.current = [];\n\n      await requestPermissions();\n\n      assert(mediaRecorder.current, 'MediaRecorder not created');\n      mediaRecorder.current.start(500);\n    } catch (err) {\n      const errMsg = isError(err)\n        ? err.message\n        : 'Something went wrong during recording';\n\n      props?.onError?.(new Event(errMsg), {\n        error: err,\n        mediaStream: mediaStream.current,\n      });\n    }\n  }, [props, requestPermissions]);\n\n  const stopRecording = useCallback(async () => {\n    try {\n      assert(mediaRecorder.current, 'MediaRecorder not created');\n\n      mediaRecorder.current.stop();\n\n      mediaStream.current?.getAudioTracks().forEach((track) => track.stop());\n    } catch (err) {\n      const errMsg = isError(err)\n        ? err.message\n        : 'Something went wrong during stopping recording';\n\n      props?.onError?.(new Event(errMsg), {\n        error: err,\n        mediaStream: mediaStream.current,\n      });\n    }\n  }, [props]);\n\n  const pauseRecording = useCallback(async () => {\n    try {\n      assert(mediaRecorder.current, 'MediaRecorder not created');\n\n      mediaRecorder.current.pause();\n    } catch (err) {\n      const errMsg = isError(err)\n        ? err.message\n        : 'Something went wrong during pausing recording';\n\n      props?.onError?.(new Event(errMsg), {\n        error: err,\n        mediaStream: mediaStream.current,\n      });\n    }\n  }, [props]);\n\n  const resumeRecording = useCallback(async () => {\n    try {\n      assert(mediaRecorder.current, 'MediaRecorder not created');\n\n      mediaRecorder.current.resume();\n    } catch (err) {\n      const errMsg = isError(err)\n        ? err.message\n        : 'Something went wrong during resuming recording';\n\n      props?.onError?.(new Event(errMsg), {\n        error: err,\n        mediaStream: mediaStream.current,\n      });\n    }\n  }, [props]);\n\n  return {\n    start: startRecording,\n    stop: stopRecording,\n    pause: pauseRecording,\n    resume: resumeRecording,\n  };\n};\n","import React from 'react';\nimport { useAudioCapture } from '~hooks/useAudioCapture.tsx';\nimport { UseAudioCaptureProps } from '~hooks/useAudioCapture.types.ts';\n\nexport const AudioRecorder: React.FC<UseAudioCaptureProps> = (props) => {\n  const { start, stop, pause, resume } = useAudioCapture(props);\n  // onStart: () => {\n  //   console.log('Recording started.');\n  // },\n  //   onStop: (_e, chunks) => {\n  //   console.log('Recording stopped.');\n  //   const blob = new Blob(chunks, { type: chunks[0].type });\n  //   const file = new File([blob], 'sampleFile.webm', {\n  //     type: chunks[0].type,\n  //   });\n  //   console.log(file);\n  // },\n  return (\n    <div>\n      <button onClick={start}>Start Recording</button>\n      <button onClick={stop}>Stop Recording</button>\n      <button onClick={pause}>Pause Recording</button>\n      <button onClick={resume}>Resume Recording</button>\n    </div>\n  );\n};\n"],"names":["f","require$$0","k","l","m","n","p","q","c","a","g","b","e","h","reactJsxRuntime_production_min","jsxRuntimeModule","assert","condition","msg","isError","error","useAudioCapture","props","chunks","useRef","mediaStream","mediaRecorder","requestPermissions","useCallback","stream","recorder","_a","startRecording","err","errMsg","_b","stopRecording","track","pauseRecording","resumeRecording","AudioRecorder","start","stop","pause","resume","jsxs","jsx"],"mappings":"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","x_google_ignoreList":[0,1]}